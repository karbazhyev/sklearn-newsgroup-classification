The code is written in just one file but each part is in a different cell (Spyder).
Running the code takes a while but produces all the figures and numbers requested.